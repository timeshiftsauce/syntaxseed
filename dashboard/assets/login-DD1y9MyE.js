var W=Object.defineProperty;var K=(a,n,u)=>n in a?W(a,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):a[n]=u;var f=(a,n,u)=>K(a,typeof n!="symbol"?n+"":n,u);import{e as j,a as _,z as O,n as X,C as G,h as E,k as c,l as o,O as r,a5 as J,s as m,a6 as Q,m as d,a7 as v,o as x,X as Y,W as Z,N as ee,V as L,U as R}from"./vue-5rLikWvG.js";import{_ as te}from"./login-header-Dbn1AN0b.js";import{e as oe,w as ae,x as ne,y as se,g as le,f as ie,r as re,z as ce,_ as de}from"./index-CE4S5SW2.js";import{l as B}from"./index-BwzKvMzm.js";import{b as w}from"./validate-BRwK53XH.js";import{c as ue}from"./index-BY8yV2QO.js";import{t as me}from"./useDark-CuPep0qW.js";const e={width:0,height:0,bubbleEl:null,canvas:null,ctx:{},circles:[],animate:!0,requestId:null},pe=function(){e.width=window.innerWidth,e.height=window.innerHeight,e.bubbleEl=document.getElementById("bubble"),e.bubbleEl.style.height=e.height+"px",e.canvas=document.getElementById("bubble-canvas"),e.canvas.width=e.width,e.canvas.height=e.height,e.ctx=e.canvas.getContext("2d"),e.circles=[];for(let a=0;a<e.width*.5;a++){const n=new fe;e.circles.push(n)}q(),he()};function M(){e.animate=!(document.body.scrollTop>e.height)}function P(){e.width=window.innerWidth,e.height=window.innerHeight,e.bubbleEl.style.height=e.height+"px",e.canvas.width=e.width,e.canvas.height=e.height}function q(){if(e.animate){e.ctx.clearRect(0,0,e.width,e.height);for(const a in e.circles)e.circles[a].draw()}e.requestId=requestAnimationFrame(q)}class fe{constructor(){f(this,"pos");f(this,"alpha");f(this,"scale");f(this,"velocity");f(this,"draw");this.pos={x:Math.random()*e.width,y:e.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random(),this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,e.ctx.beginPath(),e.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),e.ctx.fillStyle="rgba(255,255,255,"+this.alpha+")",e.ctx.fill()}}}function he(){window.addEventListener("scroll",M),window.addEventListener("resize",P)}function ge(){window.removeEventListener("scroll",M),window.removeEventListener("resize",P),cancelAnimationFrame(e.requestId)}const we={class:"switch-language"},be={class:"login"},_e={class:"login-box"},ve={class:"form"},xe=["src"],ye={class:"content"},ke=j({__name:"login",setup(a){let n;const u=oe(),T=ae();me(u.layout.isDark);const y=v("formRef"),k=v("usernameRef"),I=v("passwordRef"),h=_({showCaptcha:!1,submitLoading:!1}),s=_({username:"",password:"",keep:!1,captchaId:se(),captchaInfo:""}),{t:p}=ne.useI18n(),U=_({username:[w({name:"required",message:p("login.Please enter an account")}),w({name:"account"})],password:[w({name:"required",message:p("login.Please input a password")}),w({name:"password"})]}),D=()=>{var l,t;s.username===""?(l=k.value)==null||l.focus():s.password===""&&((t=I.value)==null||t.focus())};O(()=>{n=window.setTimeout(()=>{pe()},1e3),B("get").then(l=>{h.showCaptcha=l.data.captcha,X(()=>D())}).catch(l=>{console.log(l)})}),G(()=>{clearTimeout(n),ge()});const C=()=>{var l;(l=y.value)==null||l.validate(t=>{t&&(h.showCaptcha?ue(s.captchaId,g=>V(g)):V())})},V=(l="")=>{h.submitLoading=!0,s.captchaInfo=l,B("post",s).then(t=>{T.dataFill(t.data.userInfo,!1),re.push({path:ce})}).finally(()=>{h.submitLoading=!1})};return(l,t)=>{const g=d("Icon"),S=d("el-dropdown-item"),A=d("el-dropdown-menu"),F=d("el-dropdown"),z=d("el-input"),b=d("el-form-item"),N=d("el-checkbox"),$=d("el-button"),H=d("el-form");return x(),E("div",null,[c("div",we,[o(F,{size:"large","hide-timeout":50,placement:"bottom-end","hide-on-click":!0},{dropdown:r(()=>[o(A,{class:"chang-lang"},{default:r(()=>[(x(!0),E(Y,null,Z(m(u).lang.langArray,i=>(x(),ee(S,{key:i.name,onClick:Ie=>m(le)(i.name)},{default:r(()=>[L(R(i.value),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),default:r(()=>[o(g,{name:"fa fa-globe",color:"var(--el-text-color-secondary)",size:"28"})]),_:1})]),c("div",{onContextmenu:t[0]||(t[0]=J(()=>{},["stop"])),id:"bubble",class:"bubble"},t[6]||(t[6]=[c("canvas",{id:"bubble-canvas",class:"bubble-canvas"},null,-1)]),32),c("div",be,[c("div",_e,[t[7]||(t[7]=c("div",{class:"head"},[c("img",{src:te,alt:""})],-1)),c("div",ve,[c("img",{class:"profile-avatar",src:m(ie)("/static/images/avatar.png"),alt:""},null,8,xe),c("div",ye,[o(H,{onKeyup:t[5]||(t[5]=Q(i=>C(),["enter"])),ref_key:"formRef",ref:y,rules:U,size:"large",model:s},{default:r(()=>[o(b,{prop:"username"},{default:r(()=>[o(z,{ref_key:"usernameRef",ref:k,type:"text",clearable:"",modelValue:s.username,"onUpdate:modelValue":t[1]||(t[1]=i=>s.username=i),placeholder:m(p)("login.Please enter an account")},{prefix:r(()=>[o(g,{name:"fa fa-user",class:"form-item-icon",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(b,{prop:"password"},{default:r(()=>[o(z,{ref_key:"passwordRef",ref:I,modelValue:s.password,"onUpdate:modelValue":t[2]||(t[2]=i=>s.password=i),type:"password",placeholder:m(p)("login.Please input a password"),"show-password":""},{prefix:r(()=>[o(g,{name:"fa fa-unlock-alt",class:"form-item-icon",size:"16",color:"var(--el-input-icon-color)"})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(N,{modelValue:s.keep,"onUpdate:modelValue":t[3]||(t[3]=i=>s.keep=i),label:m(p)("login.Hold session"),size:"default"},null,8,["modelValue","label"]),o(b,null,{default:r(()=>[o($,{loading:h.submitLoading,class:"submit-button",round:"",type:"primary",size:"large",onClick:t[4]||(t[4]=i=>C())},{default:r(()=>[L(R(m(p)("login.Sign in")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])])])])])])}}}),Pe=de(ke,[["__scopeId","data-v-c512adb2"]]);export{Pe as default};
