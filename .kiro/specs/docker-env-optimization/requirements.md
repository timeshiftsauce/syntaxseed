# 需求文档

## 介绍

当前项目的环境变量配置存在硬编码问题，不利于 Docker 部署时的灵活配置。需要优化环境变量逻辑，支持通过环境变量自定义数据库地址、JWT token 配置、缓存时间等关键参数，提升部署的灵活性和安全性。

## 需求

### 需求 1

**用户故事：** 作为运维工程师，我希望能够通过环境变量配置数据库连接参数，以便在不同环境中灵活部署应用。

#### 验收标准

1. 当设置 DB_HOST 环境变量时，系统应使用该值作为数据库主机地址
2. 当设置 DB_PORT 环境变量时，系统应使用该值作为数据库端口
3. 当设置 DB_USER 环境变量时，系统应使用该值作为数据库用户名
4. 当设置 DB_PASSWORD 环境变量时，系统应使用该值作为数据库密码
5. 当设置 DB_NAME 环境变量时，系统应使用该值作为数据库名称
6. 如果环境变量未设置，系统应使用配置文件中的默认值

### 需求 2

**用户故事：** 作为运维工程师，我希望能够通过环境变量配置 Redis 连接参数，以便在容器化环境中使用不同的缓存服务。

#### 验收标准

1. 当设置 REDIS_HOST 环境变量时，系统应使用该值作为 Redis 主机地址
2. 当设置 REDIS_PORT 环境变量时，系统应使用该值作为 Redis 端口
3. 当设置 REDIS_PASSWORD 环境变量时，系统应使用该值作为 Redis 密码
4. 当设置 REDIS_PREFIX 环境变量时，系统应使用该值作为 Redis 键前缀
5. 如果环境变量未设置，系统应使用配置文件中的默认值

### 需求 3

**用户故事：** 作为安全管理员，我希望能够通过环境变量配置 JWT 相关参数，以便在不同环境中使用不同的安全配置。

#### 验收标准

1. 当设置 JWT_ACCESS_SECRET 环境变量时，系统应使用该值作为访问令牌密钥
2. 当设置 JWT_ACCESS_EXPIRES_IN 环境变量时，系统应使用该值作为访问令牌过期时间
3. 当设置 JWT_REFRESH_SECRET 环境变量时，系统应使用该值作为刷新令牌密钥
4. 当设置 JWT_REFRESH_EXPIRES_IN 环境变量时，系统应使用该值作为刷新令牌过期时间
5. 当设置 SESSION_SECRET 环境变量时，系统应使用该值作为会话密钥
6. 如果环境变量未设置，系统应使用配置文件中的默认值

### 需求 4

**用户故事：** 作为运维工程师，我希望能够通过环境变量配置应用运行参数，以便在容器化环境中优化性能和行为。

#### 验收标准

1. 当设置 PORT 环境变量时，系统应使用该值作为服务端口
2. 当设置 CLUSTER_ENABLED 环境变量时，系统应根据该值启用或禁用集群模式
3. 当设置 CLUSTER_WORKERS 环境变量时，系统应使用该值作为工作进程数量
4. 当设置 RATE_LIMIT_WINDOW_MS 环境变量时，系统应使用该值作为限流时间窗口
5. 当设置 RATE_LIMIT_MAX_REQUESTS 环境变量时，系统应使用该值作为最大请求数
6. 如果环境变量未设置，系统应使用配置文件中的默认值

### 需求 5

**用户故事：** 作为运维工程师，我希望能够通过环境变量配置邮件服务参数，以便在不同环境中使用不同的邮件服务提供商。

#### 验收标准

1. 当设置 MAIL_HOST 环境变量时，系统应使用该值作为邮件服务器地址
2. 当设置 MAIL_PORT 环境变量时，系统应使用该值作为邮件服务器端口
3. 当设置 MAIL_SECURE 环境变量时，系统应根据该值启用或禁用 SSL
4. 当设置 MAIL_USER 环境变量时，系统应使用该值作为邮件用户名
5. 当设置 MAIL_PASS 环境变量时，系统应使用该值作为邮件密码
6. 当设置 MAIL_FROM 环境变量时，系统应使用该值作为发件人地址
7. 如果环境变量未设置，系统应使用配置文件中的默认值

### 需求 6

**用户故事：** 作为开发者，我希望系统能够提供清晰的环境变量文档和示例，以便快速了解如何配置不同环境。

#### 验收标准

1. 当查看项目文档时，应包含完整的环境变量列表和说明
2. 当查看 Docker Compose 配置时，应包含环境变量配置示例
3. 当查看环境变量配置文件时，应包含详细的注释说明
4. 当环境变量配置错误时，系统应提供清晰的错误信息
5. 系统应提供环境变量验证机制，确保必要参数已正确设置
