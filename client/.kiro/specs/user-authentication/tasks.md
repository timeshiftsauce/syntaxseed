# 用户认证系统实施计划

- [x] 1. 完善API服务层和类型定义
  - 扩展userApi.ts中的API方法，添加发送邮箱验证码和验证邮箱验证码的方法
  - 完善apiType.ts中的类型定义，添加邮箱验证码相关的响应类型
  - 创建表单验证规则的类型定义
  - _需求: 2.1, 2.2, 6.1_

- [x] 2. 实现验证码功能组件
  - [x] 2.1 实现图形验证码显示和刷新功能
    - 在Login.vue中添加图形验证码的获取和显示逻辑
    - 实现点击验证码图片刷新功能
    - 添加验证码加载状态处理
    - _需求: 1.1, 1.2, 1.3_

  - [x] 2.2 实现邮箱验证码发送功能
    - 添加发送邮箱验证码的按钮和倒计时功能
    - 实现邮箱格式验证后才能发送验证码
    - 添加发送成功/失败的提示处理
    - _需求: 2.1, 2.2, 2.3_

- [x] 3. 完善表单验证系统
  - [x] 3.1 实现登录表单验证规则
    - 创建邮箱格式验证规则
    - 创建密码强度验证规则
    - 创建验证码必填验证规则
    - 修复模板中的loginForm引用错误
    - _需求: 6.1, 6.2_

  - [x] 3.2 实现注册表单验证规则
    - 创建用户名长度和格式验证规则
    - 创建密码确认匹配验证规则
    - 创建邮箱验证码验证规则
    - 完善注册表单的字段绑定
    - _需求: 6.1, 6.2_

- [x] 4. 实现用户登录功能
  - [x] 4.1 实现登录表单提交逻辑
    - 创建handleLogin方法处理登录表单提交
    - 集成图形验证码验证
    - 实现登录成功后的状态更新和页面跳转
    - 添加登录失败的错误处理和提示
    - _需求: 4.1, 4.2, 4.3, 4.4_

  - [x] 4.2 集成用户状态管理
    - 完善userAuth Store中的login方法，集成真实API调用
    - 实现登录成功后用户信息和token的保存
    - _需求: 4.5, 5.1_

- [x] 5. 实现用户注册功能
  - [x] 5.1 实现注册表单提交逻辑
    - 创建handleRegister方法处理注册表单提交
    - 集成邮箱验证码验证流程
    - 实现注册成功后自动登录功能 注册成功已经自动登录返回token
    - 添加注册失败的错误处理（邮箱已存在等）
    - 在恰当的位置添加反回上一页功能
    - 登陆后确保正确跳转 链接query /Login?redirect= <path>
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

- [ ] 6. 实现错误处理和用户体验优化
  - [ ] 6.1 实现统一错误处理机制
    - 创建错误类型枚举和错误处理工具函数
    - 实现不同错误类型的差异化处理逻辑
    - 集成Toast提示服务显示错误信息
    - 添加网络错误重试机制
    - _需求: 6.3, 6.4_

  - [ ] 6.2 实现加载状态和用户反馈
    - 为所有异步操作添加加载状态指示
    - 实现表单提交时的按钮禁用状态
    - 添加操作成功的提示消息
    - 实现验证码发送倒计时显示
    - _需求: 6.5_

- [-] 7. 实现响应式设计适配
  - [ ] 7.1 优化移动端显示效果
    - 测试并调整现有CSS媒体查询规则
    - 确保表单在小屏幕设备上的可用性
    - 优化触摸设备上的交互体验
    - 测试键盘弹出时的布局适配
    - _需求: 7.1, 7.2, 7.3, 7.4_

- [ ] 8. 实现会话管理和自动刷新
  - [ ] 8.1 完善token自动刷新机制
    - 测试现有的token刷新逻辑
    - 优化refresh token过期时的处理
    - 实现页面刷新后的登录状态恢复
    - 添加自动登出的用户提示
    - _需求: 5.2, 5.3, 5.4, 5.5_

- [ ] 9. 集成测试和调试
  - [ ] 9.1 创建认证功能的集成测试
    - 编写完整登录流程的测试用例
    - 编写完整注册流程的测试用例
    - 测试各种错误场景的处理
    - 验证响应式设计在不同设备上的表现
    - _需求: 所有需求的综合验证_

- [ ] 10. 代码优化和文档完善
  - [ ] 10.1 代码重构和性能优化
    - 清理未使用的导入和变量
    - 优化组件的性能和内存使用
    - 添加必要的代码注释和文档
    - 确保代码符合项目的编码规范
    - _需求: 性能和维护性要求_
