# 设计文档：博客详情页面

## 概述

博客详情页面是SyntaxSeed平台的核心功能之一，用于展示完整的博客文章内容。该页面将以美观、易读的方式呈现文章内容，并提供相关导航和交互功能，增强用户阅读体验。设计将遵循项目的设计系统，确保与整体风格一致，同时优化移动端和桌面端的显示效果。

## 架构

博客详情页面将采用Vue 3的Composition API实现，遵循组件化设计原则。页面将分为以下几个主要部分：

1. **页面容器**：负责整体布局和状态管理
2. **文章头部**：显示标题、封面图、元信息（日期、阅读时间、标签等）
3. **文章内容**：显示格式化的文章正文
4. **文章导航**：提供上一篇/下一篇文章的导航
5. **评论区域**：显示和提交评论的功能区

页面将使用Vue Router获取文章ID参数，通过API获取文章详情数据，并在组件中进行渲染。

## 组件和接口

### 主要组件

1. **BlogDetailView**：页面主容器组件
   - 负责获取和管理文章数据
   - 处理加载状态和错误状态
   - 协调子组件的渲染

2. **ArticleHeader**：文章头部组件
   - 显示文章标题、封面图
   - 显示发布日期、阅读时间、标签等元信息
   - 提供分享功能

3. **ArticleContent**：文章内容组件
   - 渲染HTML格式的文章内容
   - 处理代码高亮
   - 处理图片查看功能

4. **ArticleNavigation**：文章导航组件
   - 显示上一篇/下一篇文章的链接
   - 处理导航交互

5. **CommentSection**：评论区组件
   - 显示评论列表
   - 提供评论提交表单
   - 处理评论分页

### 接口定义

1. **获取文章详情**
   - 已有API：`getBlogDetail(id)`
   - 返回数据结构：
     ```typescript
     interface BlogDetail {
       id: number | string;
       title: string;
       excerpt: string;
       content: string;
       image: string;
       tags: string[];
       readTime: number;
       create_time: number;
       prevPost?: {
         id: string | number;
         title: string;
       };
       nextPost?: {
         id: string | number;
         title: string;
       };
     }
     ```

2. **获取文章评论**（需要后端实现）
   - API：`getComments(blogId, page, limit)`
   - 返回数据结构：

     ```typescript
     interface CommentsResponse {
       data: Comment[];
       total: number;
       page: number;
       limit: number;
     }

     interface Comment {
       id: number | string;
       author: string;
       content: string;
       create_time: number;
       avatar?: string;
     }
     ```

3. **提交评论**（需要后端实现）
   - API：`submitComment(blogId, commentData)`
   - 请求数据结构：
     ```typescript
     interface CommentSubmission {
       author: string;
       content: string;
       email: string; // 用于头像和通知
       website?: string; // 可选，用户个人网站
       blog_id: string; // 文章id
       parent_id?: string; // 可选，回复的评论ID
     }
     ```

## 数据模型

### 文章详情模型

```typescript
interface BlogDetail {
  id: string;
  title: string;
  excerpt: string;
  content: string;
  image: string;
  tags: string[];
  readTime: number;
  create_time: number;
  prevPost?: {
    id: string | number;
    title: string;
  };
  nextPost?: {
    id: string | number;
    title: string;
  };
}
```

### 评论模型

```typescript
interface Comment {
  id: string;
  author: string;
  content: string;
  create_time: number;
  avatar?: string;
  website?: string; // 用户个人网站
  parent_id?: string; // 父评论ID，用于回复功能
  replies?: Comment[]; // 回复列表
}
```

### 页面状态模型

```typescript
interface PageState {
  loading: boolean;
  error: string | null;
  blog: BlogDetail | null;
  comments: {
    data: Comment[];
    loading: boolean;
    error: string | null;
    page: number;
    limit: number;
    total: number;
  };
}
```

## 错误处理

1. **文章加载失败**
   - 显示友好的错误提示
   - 提供重试按钮
   - 记录错误日志

2. **评论加载失败**
   - 显示独立的错误提示
   - 不影响文章内容的显示
   - 提供重试按钮

3. **评论提交失败**
   - 保留用户输入的内容
   - 显示具体的错误原因
   - 提供重试选项

## 测试策略

1. **单元测试**
   - 测试各组件的渲染逻辑
   - 测试数据处理函数
   - 测试错误处理逻辑

2. **集成测试**
   - 测试组件间的交互
   - 测试API调用和数据流
   - 测试路由参数处理

3. **端到端测试**
   - 测试完整的用户流程
   - 测试不同设备和屏幕尺寸的响应式布局
   - 测试无障碍功能

## 页面布局设计

### 桌面端布局

```
+-----------------------------------------------+
|                 导航栏/头部                    |
+-----------------------------------------------+
|                                               |
|  +-------------------------------------------+  |
|  |              文章封面图（可选）            |  |
|  +-------------------------------------------+  |
|                                               |
|  +-------------------------------------------+  |
|  |                文章标题                    |  |
|  +-------------------------------------------+  |
|                                               |
|  +-------------------------------------------+  |
|  |    发布日期 | 阅读时间 | 标签              |  |
|  +-------------------------------------------+  |
|                                               |
|  +-------------------------------------------+  |
|  |                                           |  |
|  |                文章内容                    |  |
|  |                                           |  |
|  |                                           |  |
|  +-------------------------------------------+  |
|                                               |
|  +-------------------------------------------+  |
|  |        上一篇         |        下一篇      |  |
|  +-------------------------------------------+  |
|                                               |
|  +-------------------------------------------+  |
|  |                评论区                      |  |
|  |  +-------------------------------------+  |  |
|  |  |            评论表单                 |  |  |
|  |  +-------------------------------------+  |  |
|  |                                           |  |
|  |  +-------------------------------------+  |  |
|  |  |            评论列表                 |  |  |
|  |  +-------------------------------------+  |  |
|  +-------------------------------------------+  |
|                                               |
+-----------------------------------------------+
|                  页脚                         |
+-----------------------------------------------+
```

### 移动端布局

```
+----------------------------+
|          导航栏/头部        |
+----------------------------+
|                            |
|  +------------------------+  |
|  |       文章封面图       |  |
|  +------------------------+  |
|                            |
|  +------------------------+  |
|  |        文章标题        |  |
|  +------------------------+  |
|                            |
|  +------------------------+  |
|  |  发布日期 | 阅读时间   |  |
|  +------------------------+  |
|                            |
|  +------------------------+  |
|  |        标签列表        |  |
|  +------------------------+  |
|                            |
|  +------------------------+  |
|  |                        |  |
|  |       文章内容         |  |
|  |                        |  |
|  |                        |  |
|  +------------------------+  |
|                            |
|  +------------------------+  |
|  |  上一篇   |   下一篇   |  |
|  +------------------------+  |
|                            |
|  +------------------------+  |
|  |        评论区          |  |
|  |  +------------------+  |  |
|  |  |     评论表单     |  |  |
|  |  +------------------+  |  |
|  |                        |  |
|  |  +------------------+  |  |
|  |  |     评论列表     |  |  |
|  |  +------------------+  |  |
|  +------------------------+  |
|                            |
+----------------------------+
|           页脚             |
+----------------------------+
```

## 交互设计

1. **文章内容交互**
   - 代码块：提供复制代码按钮
   - 图片：点击可放大查看
   - 链接：悬停时显示提示

2. **评论区交互**
   - 评论表单：
     - 实时验证输入（名称、邮箱、内容）
     - 提供名称、邮箱、网站和评论内容的输入字段
     - 支持Markdown或基本HTML格式化
     - 显示字数统计和剩余字符数
   - 提交按钮：
     - 显示加载状态和动画效果
     - 提交成功后显示成功反馈
   - 评论列表：
     - 支持分页加载更多
     - 显示用户头像（基于邮箱的Gravatar）
     - 如有网站链接，用户名可点击跳转
     - 每条评论提供回复按钮
     - 回复表单可内嵌在评论下方
     - 回复内容以树形结构显示，有明显的层级视觉区分

3. **导航交互**
   - 上一篇/下一篇：悬停时显示文章标题预览
   - 返回列表：提供返回博客列表的链接

## 无障碍设计

1. **键盘导航**
   - 所有交互元素可通过Tab键访问
   - 提供清晰的焦点样式

2. **屏幕阅读器支持**
   - 使用适当的ARIA标签
   - 确保内容结构合理

3. **减少动画**
   - 尊重用户的减少动画偏好
   - 提供无动画的替代方案

## 性能优化

1. **图片优化**
   - 使用懒加载技术
   - 根据设备提供适当尺寸的图片

2. **代码分割**
   - 将Prism.js等大型库进行按需加载
   - 使用动态导入减少初始加载时间

3. **缓存策略**
   - 缓存已加载的文章数据
   - 实现预加载上一篇/下一篇文章

## 视

觉设计指南

为了确保博客详情页面具有现代科技感的风格，同时保持良好的可读性和用户体验，我们将遵循以下视觉设计指南：

### 整体风格

1. **现代科技感**
   - 使用几何形状和线条创建科技感
   - 应用微妙的渐变效果增强深度感
   - 采用简洁、精确的排版强调技术性
   - 使用适当的动效增强交互体验

2. **色彩方案**
   - 主要使用项目定义的色彩变量：
     ```css
     --color-primary-light: #f0f7ff; /* 浅色模式背景 */
     --color-primary-dark: #0a192f; /* 深色模式背景 */
     --color-accent-teal: #2a9d8f; /* 交互元素 */
     --color-accent-cyan: #64ffda; /* 高亮、代码语法 */
     ```
   - 添加科技感辅助色：
     ```css
     --color-tech-blue: #0066ff; /* 科技蓝，用于强调 */
     --color-tech-purple: #6e57e0; /* 科技紫，用于装饰元素 */
     --color-tech-glow: rgba(100, 255, 218, 0.15); /* 霓虹光效 */
     ```

3. **排版处理**
   - 文章标题：大号字体，粗体，可应用微妙的渐变效果
   - 文章内容：优先可读性，适当行高和段落间距
   - 代码块：使用等宽字体，添加语法高亮和行号
   - 引用和强调：使用边框和背景色区分

### 元素设计

1. **卡片和容器**
   - 使用微妙的阴影效果创造层次感
   - 应用半透明背景和模糊效果（backdrop-filter）
   - 边角适当圆润（8-12px圆角）
   - 边框可使用渐变色或微妙发光效果

2. **按钮和交互元素**
   - 悬停时添加微妙的缩放和发光效果
   - 使用图标+文字组合增强可识别性
   - 状态变化时应用平滑过渡动画
   - 强调按钮可使用渐变背景

3. **装饰元素**
   - 添加抽象几何形状作为背景装饰
   - 使用网格或点阵图案增强科技感
   - 应用微妙的粒子或光效动画
   - 在关键区域使用强调线条或边框

### 响应式设计考量

1. **桌面端增强**
   - 使用更复杂的布局和动效
   - 添加悬停状态的交互反馈
   - 可展示更多装饰性元素

2. **移动端优化**
   - 简化视觉元素，专注于内容
   - 增大触摸目标，优化操作体验
   - 减少装饰元素，保留核心视觉特征

### 动效指南

1. **微交互**
   - 按钮点击：轻微缩放+波纹效果
   - 表单输入：边框颜色变化+微妙发光
   - 卡片悬停：轻微上浮+阴影增强

2. **页面过渡**
   - 内容加载：渐显+轻微上移
   - 页面切换：平滑淡入淡出
   - 模态框：缩放+透明度变化

3. **装饰动效**
   - 背景元素：缓慢漂浮或旋转
   - 强调元素：呼吸效果（透明度或大小变化）
   - 加载状态：科技感进度条或脉冲效果
